#include <stdio.h>
#include <stdlib.h>
#include <windows.h> // Для поддержки UTF-8 в консоли Windows

// Определение структуры узла двусвязного списка
// Каждый узел содержит:
// - целочисленное значение (data)
// - указатель на предыдущий узел (prev)
// - указатель на следующий узел (next)
typedef struct Node {
    int data;              // Данные, хранящиеся в узле
    struct Node* prev;     // Указатель на предыдущий узел в списке (или NULL, если это первый элемент)
    struct Node* next;     // Указатель на следующий узел в списке (или NULL, если это последний элемент)
} Node;

// Функция добавления нового элемента в начало двусвязного списка (push)
// head — указатель на указатель на голову списка (чтобы можно было изменить сам указатель head в main)
// value — значение, которое нужно добавить в список
void push(Node** head, int value) {
    // Выделяем память под новый узел
    Node* newNode = (Node*)malloc(sizeof(Node));


    // Инициализируем поля нового узла
    newNode->data = value;   // Записываем переданное значение
    newNode->prev = NULL;    // Так как добавляем в начало, предыдущий узел — отсутствует
    newNode->next = *head;   // Следующий узел — это текущая голова списка (или NULL, если список был пуст)

    // Если список не пуст, обновляем указатель prev у старой головы,
    // чтобы он указывал на новый узел (поддерживаем двусвязность)
    if (*head != NULL)
        (*head)->prev = newNode;

    // Обновляем голову списка — теперь это новый узел
    *head = newNode;
}

// Главная функция программы
int main() {
    // Устанавливаем кодировку вывода консоли Windows в UTF-8,
    // чтобы корректно отображались русские символы и другие Unicode-символы
    SetConsoleOutputCP(CP_UTF8);

    int n; // Количество элементов, которые введёт пользователь
    printf("Введите количество элементов: ");
    scanf("%d", &n); // Считываем количество элементов

    // Инициализируем голову списка как NULL (список пока пуст)
    Node* head = NULL;

    // Запрашиваем у пользователя n целых чисел и добавляем их в список
    printf("Введите %d целых чисел:\n", n);
    for (int i = 0; i < n; i++) {
        int value;
        scanf("%d", &value);         // Считываем число
        push(&head, value);          // Добавляем его в начало списка

    // Переменная для накопления результата произведения
    double summ = 1.0; // Начинаем с 1.0, так как будем умножать

    // Указатель для прохода по списку
    //current проход от начала списка до конца
    Node* current = head;

    // Проходим по всем n элементам списка
    for (int i = 0; i < n; i++) {
        // Текущий элемент списка
        int xi = current->data;

        // Следующий элемент (если существует, иначе 0)
        // Тернарный оператор: если current->next не NULL, берём его data, иначе 0
        int xi1 = (current->next) ? current->next->data : 0;

        // Предыдущий элемент (если существует, иначе 0)
        int xj = (current->prev) ? current->prev->data : 0;

        // Вычисляем множитель по формуле: xi + xi1 + 2 * xj
        double multiplier = xi + xi1 + 2 * xj;

        // Умножаем текущее значение summ на вычисленный множитель
        summ *= multiplier;

        // Переходим к следующему узлу в списке
        current = current->next;
    }

    // Выводим итоговый результат с точностью до 2 знаков после запятой
    printf("Результат: %.2f\n", summ);


    return 0; // Успешное завершение программы
}